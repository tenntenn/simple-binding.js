/*! simple-binding - v0.0.1 - 2012-11-12
* https://github.com/tenntenn/simple-binding.js
* Copyright (c) 2012 ; Licensed MIT */
(function(e,t){typeof define=="function"&&define.amd?define(["ko"],t):e.sb=t(e.ko)})(this,function(e){return define("sb/util/argumentsToArray",[],function(){function e(e){var t=[];return Object.keys(e).forEach(function(n){t.push(e[n])}),t}return e}),define("sb/util/expandable",["sb/util/argumentsToArray"],function(e){function t(){var t=function(){var n=e(arguments);t.funcs.forEach(function(e){e.apply(t,n)})},n=e(arguments);return t.funcs=n.filter(function(e){return typeof e=="function"}),t.expand=function(e){return typeof e=="function"&&t.funcs.push(e),t},t}return t}),define("sb/util/main",["sb/util/argumentsToArray","sb/util/expandable"],function(e,t){var n={argumentsToArray:e,expandable:t};return n}),define("sb/base/observable/newObservable",[],function(){function e(e,t){function n(r){var i;return r!==undefined&&(i=e.getPropagationGuardian().createPropagation(),n.notify(i,r)),t}return n.notify=function(r,i){var s={previousValue:t,newValue:i};r(n,s)&&(t=i,e.notify(r,n))},n}return e}),define("sb/base/observable/Observable",function(){}),define("sb/base/observable/newObservableArray",["sb/util"],function(e){function t(t,n){var r=n;r instanceof Array||(r=[]);var i=function(){return r.concat()};return i.notify=function(e,n){e(i,i)&&t.notify(e,i)},i.length=function(){return r.length},i.get=function(e){return r[e]},i.set=function(e,n){var s=t.getPropagationGuardian().createPropagation();r[e]=n,i.notify(s,r)},["push","pop","shift","unshift","splice","reverse","sort"].forEach(function(n){typeof r[n]=="function"&&(i[n]=function(){var s=e.argumentsToArray(arguments),o=r[n].apply(r,s),u=t.getPropagationGuardian().createPropagation();return i.notify(u),o})}),["concat","map","filter"].forEach(function(n){typeof r[n]=="function"&&(i[n]=function(){var i=e.argumentsToArray(arguments),s=r[n].apply(r,i),o=new sb.ObservableArray(t,s);return o})}),["join","toString","toLocalString","indexOf","lastIndexOf","forEach"].forEach(function(t){typeof r[t]=="function"&&(i[t]=function(){var n=e.argumentsToArray(arguments),i=r[t].apply(r,n);return i})}),i}return t}),define("sb/base/observable/ObservableArray",function(){}),define("sb/base/observable/isObservableObject",[],function(){function e(e){return typeof e!="function"?!1:!e.notify||typeof e.notify!="function"?!1:!0}return e}),define("sb/base/observable/ObservableObject",function(){}),define("sb/base/observable/main",["sb/base/observable/Observable","sb/base/observable/ObservableArray","sb/base/observable/ObservableObject"],function(e,t,n){var r={newObservable:e,newObservableArray:t,isObservableObject:n};return r}),define("sb/base/binding/PropagationGuardian",[],function(){function e(e,t){typeof e!="function"&&(e=function(){return!0});if(typeof t!="number"||t<=0)t=1;this.createPropagation=function(){var n=[],r=function(i,s){r.callStack=function(){return n.concat()},r.getSource=function(){return i},r.getEventObject=function(){return s};var o=0;return n.forEach(function(e){e===i&&o++}),t<=o?!1:e(i,s)?(n.push(i),!0):!1};return r}}return e}),define("sb/base/binding/DEFAULT_PROPAGATION_GURDIAN",["sb/base/binding/PropagationGuardian"],function(e){var t=new e(null,1);return t}),define("sb/base/binding/Observer",["sb/base/binding/PropagationGuardian","sb/base/binding/DEFAULT_PROPAGATION_GURDIAN"],function(e,t){function n(n){if(!n||!n instanceof e)n=t;var r=[];this.getPropagationGuardian=function(){return n},this.add=function(e){if(e===null||typeof e=="undefined")return;r.indexOf(e)<0&&r.push(e)},this.notify=function(e,t){var n=r.filter(function(e){var n=!1;return Object.keys(e.inputs).forEach(function(r){if(e.inputs.hasOwnProperty(r)&&e.inputs[r]===t){n=!0;return}}),n});n.forEach(function(t){t.notify(e)})},this.remove=function(e){var t=r.lastIndexOf(e);t>=0&&r.splice(t,1)}}return n}),define("sb/base/binding/Binding",["sb/base/observable/isObservableObject"],function(e){function t(t,n,r,i){var s=this;s.inputs=n,s.outputs=r,s.computed=i,s.bind=function(){return t.add(s),s},s.unbind=function(){return t.remove(s),s},s.notify=function(t){var o=t.getSource(),u=t.getEventObject(),a=i(n,o,u),f=t.callStack(),l=f[f.length-1];return Object.keys(a).forEach(function(n){var i=r[n];l!==i&&r.hasOwnProperty(n)&&e(i)&&i.notify(t,a[n])}),s}}return t}),define("sb/base/binding/BindingChain",["sb/util/main","sb/base/binding/Binding","sb/base/observable/isObservableObject"],function(e,t,n){function r(r,i){var s=sb.util.expandable(),o=[];this.synchronize=function(){var u=e.argumentsToArray(arguments),a=[];u.forEach(function(e){n(e)&&(a.push(e),i.indexOf(e)<0&&i.push(e))});var f=a.map(function(e){var n={input:e},i={};a.forEach(function(t,n){e!==t&&(i["output"+n]=t)});var s=function(e){var t={};return Object.keys(i).forEach(function(n){t[n]=e.input()}),t},o=new t(r,n,i,s);return o});return s.expand(function(){o=o.concat(f)}),this},this.computed=function(e,t){return!sb.base.observable.isObservableObject(e)||typeof t!="function"?this:(i.indexOf(e)<0&&i.push(e),s.expand(function(){var n={};i.forEach(function(t,r){e!==t&&(n["input"+r]=t)});var s={output:e},u=new sb.base.binding.Binding(r,n,s,function(e,n,r){return{output:t(e,n,r)}});o.push(u)}),this)},this.onChange=function(e,t){if(!sb.base.observable.isObservableObject(e)||typeof t!="function")return this;i.indexOf(e)&&i.push(e);var n=new sb.base.binding.Binding(r,{input:e},{},function(e,n,r){return t(n,r),{}});return s.expand(function(){o.push(n)}),this},this.bind=function(){return this.unbind(),s(),o.forEach(function(e){e.bind()}),this},this.unbind=function(){return o.forEach(function(e){e.unbind()}),o=[],this}}return r}),define("sb/base/binding/main",["sb/base/binding/Observer","sb/base/binding/Binding","sb/base/binding/BindingChain","sb/base/binding/PropagationGuardian","sb/base/binding/DEFAULT_PROPAGATION_GURDIAN"],function(e,t,n,r,i){var s={Observer:e,Binding:t,BindingCain:n,PropagationGuardian:r,DEFAULT_PROPAGATION_GURDIAN:i};return s}),define("sb/base/main",["sb/base/observable/main","sb/base/binding/main"],function(e,t){var n={observable:e,binding:t};return n}),define("sb/main",["sb/util/main","sb/base/main"],function(e,t){var n={util:e,base:t};return n}),define("ko",function(){return e}),require("main")});