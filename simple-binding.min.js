var sb={extend:function(d,a){function b(){}b.property=d.property;a.property=new b;a.superclass=d.property;a.superclass.constructor=d;return a.property.constructor=a},BindingMaster:function(){var d=[];this.add=function(a){null===a||"undefined"===typeof a||0>d.indexOf(a)&&d.push(a)};this.notify=function(a,b){d.filter(function(a){var e=!1;Object.keys(a.inputs).forEach(function(d){a.inputs.hasOwnProperty(d)&&a.inputs[d]===b&&(e=!0)});return e}).forEach(function(c){c.notify(a)})};this.remove=function(a){a=
d.lastIndexOf(a);0<=a&&d.splice(a,1)}},Binding:function(d,a,b,c){this.inputs=a;this.outputs=b;this.compute=c;this.bind=function(){d.add(this);return this};this.unbind=function(){d.remove(this);return this};this.notify=function(d){var f=c(a),g=d[d.length-1];Object.keys(f).forEach(function(a){var c=b[a];g!==c&&(b.hasOwnProperty(a)&&sb.isObservable(c))&&c.notify(d,f[a])});return this}},Observable:function(d,a){var b=function(c){void 0!==c&&b.notify([],c);return a};b.notify=function(c,e){0>c.lastIndexOf(b)&&
(a=e,d.notify(c.concat(b),b))};b.observable=this;this.property=b}};
(function(){sb.ObservableArray=function(d,a){a instanceof Array||(a=[]);var b=function(){return a.concat()};b.notify=function(a){0>a.lastIndexOf(b)&&d.notify(a.concat(b),b)};b.length=function(){return a.length};b.get=function(c){return a[c]};b.set=function(c,d){a[c]=d;b.notify([])};"push pop shift unshift splice reverse sort".split(" ").forEach(function(c){"function"===typeof a[c]&&(b[c]=function(){var d=sb.argumentsToArray(arguments),d=a[c].apply(a,d);b.notify([]);return d})});["concat","map","filter"].forEach(function(c){"function"===
typeof a[c]&&(b[c]=function(){var b=sb.argumentsToArray(arguments),b=a[c].apply(a,b);return new ObservableArray(d,b)})});"join toString toLocalString indexOf lastIndexOf forEach".split(" ").forEach(function(c){"function"===typeof a[c]&&(b[c]=function(){var b=sb.argumentsToArray(arguments);return a[c].apply(a,b)})});b.observable=this;this.property=b}})();
(function(){sb.BindingChain=function(d,a){var b=[];this.synchronize=function(){var c=[],e=arguments;Object.keys(e).forEach(function(b){b=e[b];sb.isObservable(b)&&0<=a.indexOf(b)&&c.push(b)});c.forEach(function(a){var e={input:a},h={};c.forEach(function(b,c){a!==b&&(h["output"+c]=b)});e=new sb.Binding(d,e,h,function(a){var b={};Object.keys(h).forEach(function(c){b[c]=a.input()});return b});b.push(e)});return this};this.compute=function(c,e){if(!sb.isObservable(c)||"function"!==typeof e||0>a.indexOf(c))return this;
var f={};a.forEach(function(a,b){c!==a&&(f["input"+b]=a)});var g=new sb.Binding(d,f,{output:c},function(a){return{output:e(a)}});b.push(g);return this};this.onChange=function(c,e){if(!sb.isObservable(c)||"function"!==typeof e||0>a.indexOf(c))return this;var f=new sb.Binding(d,{input:c},{},function(){e();return{}});b.push(f);return this};this.bind=function(){b.forEach(function(a){a.bind()});return this};this.unbind=function(){b.forEach(function(a){a.unbind()});return this}}})();
sb.argumentsToArray=function(d){var a=[];Object.keys(d).forEach(function(b){a.push(d[b])});return a};
(function(){var d=new sb.BindingMaster;sb.binding=function(){var a=[],b=arguments;Object.keys(b).forEach(function(c){c=b[c];sb.isObservable(c)&&a.push(c)});return new sb.BindingChain(d,a)};sb.observable=function(a){return(new sb.Observable(d,a)).property};sb.observableArray=function(a){return(new sb.ObservableArray(d,a)).property};sb.isObservable=function(a){return a instanceof sb.Observable||a.observable&&a.observable instanceof sb.Observable||a instanceof sb.ObservableArray||a.observable&&a.observable instanceof
sb.ObservableArray?!0:!1}})();
