var sb={extend:function(b,a){function d(){}d.property=b.property;a.property=new d;a.superclass=b.property;a.superclass.constructor=b;return a.property.constructor=a},Observer:function(){var b=[];this.add=function(a){null===a||"undefined"===typeof a||0>b.indexOf(a)&&b.push(a)};this.notify=function(a,d){b.filter(function(c){var a=!1;Object.keys(c.inputs).forEach(function(b){c.inputs.hasOwnProperty(b)&&c.inputs[b]===d&&(a=!0)});return a}).forEach(function(c){c.notify(a)})};this.remove=function(a){a=
b.lastIndexOf(a);0<=a&&b.splice(a,1)}},Binding:function(b,a,d,c){this.inputs=a;this.outputs=d;this.compute=c;this.bind=function(){b.add(this);return this};this.unbind=function(){b.remove(this);return this};this.notify=function(b){var f=c(a),g=b[b.length-1];Object.keys(f).forEach(function(c){var a=d[c];g!==a&&(d.hasOwnProperty(c)&&sb.isObservable(a))&&a.notify(b,f[c])});return this}},isObservable:function(b){return"function"!==typeof b||!b.notify||"function"!==typeof b.notify?!1:!0},Observable:function(b,
a){var d=this;d.property=function(c){void 0!==c&&d.property.notify([],c);return a};d.property.notify=function(c,e){0>c.lastIndexOf(d.property)&&(a=e,b.notify(c.concat(d.property),d.property))}}};
(function(){sb.ObservableArray=function(b,a){var d=this,c=a;c instanceof Array||(c=[]);d.property=function(){return c.concat()};d.property.notify=function(c){0>c.lastIndexOf(d.property)&&b.notify(c.concat(d.property),d.property)};d.property.length=function(){return c.length};d.property.get=function(a){return c[a]};d.property.set=function(a,b){c[a]=b;d.property.notify([])};"push pop shift unshift splice reverse sort".split(" ").forEach(function(a){"function"===typeof c[a]&&(d.property[a]=function(){var b=
sb.argumentsToArray(arguments),b=c[a].apply(c,b);d.property.notify([]);return b})});["concat","map","filter"].forEach(function(a){"function"===typeof c[a]&&(d.property[a]=function(){var d=sb.argumentsToArray(arguments),d=c[a].apply(c,d);return new sb.ObservableArray(b,d)})});"join toString toLocalString indexOf lastIndexOf forEach".split(" ").forEach(function(a){"function"===typeof c[a]&&(d.property[a]=function(){var b=sb.argumentsToArray(arguments);return c[a].apply(c,b)})})}})();
(function(){sb.BindingChain=function(b,a){var d=[];this.synchronize=function(){var c=[],e=arguments;Object.keys(e).forEach(function(b){b=e[b];sb.isObservable(b)&&0<=a.indexOf(b)&&c.push(b)});c.forEach(function(a){var e={input:a},h={};c.forEach(function(c,b){a!==c&&(h["output"+b]=c)});e=new sb.Binding(b,e,h,function(a){var c={};Object.keys(h).forEach(function(b){c[b]=a.input()});return c});d.push(e)});return this};this.compute=function(c,e){if(!sb.isObservable(c)||"function"!==typeof e||0>a.indexOf(c))return this;
var f={};a.forEach(function(a,b){c!==a&&(f["input"+b]=a)});var g=new sb.Binding(b,f,{output:c},function(a){return{output:e(a)}});d.push(g);return this};this.onChange=function(c,e){if(!sb.isObservable(c)||"function"!==typeof e||0>a.indexOf(c))return this;var f=new sb.Binding(b,{input:c},{},function(){e();return{}});d.push(f);return this};this.bind=function(){d.forEach(function(a){a.bind()});return this};this.unbind=function(){d.forEach(function(a){a.unbind()});return this}}})();
sb.argumentsToArray=function(b){var a=[];Object.keys(b).forEach(function(d){a.push(b[d])});return a};(function(){var b=new sb.Observer;sb.binding=function(){var a=sb.argumentsToArray(arguments).filter(function(a){return sb.isObservable(a)});return new sb.BindingChain(b,a)};sb.observable=function(a){return(new sb.Observable(b,a)).property};sb.observableArray=function(a){return(new sb.ObservableArray(b,a)).property}})();
